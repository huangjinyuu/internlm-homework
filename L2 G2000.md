# Lagent

## 配环境

```
# 创建环境
conda create -n agent_camp3 python=3.10 -y
# 激活环境
conda activate agent_camp3
# 安装 torch
conda install pytorch==2.1.2 torchvision==0.16.2 torchaudio==2.1.2 pytorch-cuda=12.1 -c pytorch -c nvidia -y
# 安装其他依赖包
pip install termcolor==2.4.0
pip install lmdeploy==0.5.2

# 安装lagent
mkdir -p /root/agent_camp3
cd /root/agent_camp3
git clone https://github.com/InternLM/lagent.git
cd lagent && git checkout 81e7ace && pip install -e . && cd ..
pip install griffe==0.48.0
```

## 体验 Lagent Web Demo

第一步，通过 `lmdeploy` 部署一个 `api_server` :

![image](https://github.com/user-attachments/assets/b4414694-7c5c-4739-99f5-834f1b17aef0)


第二步，启动 `Lagent` 的Web Demo：

![image](https://github.com/user-attachments/assets/18695f9e-f259-4fb1-8bc4-6b4b3f8addfc)

神奇：
![image](https://github.com/user-attachments/assets/fe7da34b-5d1f-4b27-b88f-ec3cf46efe09)

`Lagent Web Demo` 代码逻辑流程图：

![image](https://github.com/user-attachments/assets/7081e4da-0b85-41dc-a0d8-5d5a0b89e0d4)


## 自定义 Agent 智能体

MagicMaker 代码逻辑流程图：

![image](https://github.com/user-attachments/assets/b28a6154-569e-4cc0-b398-095932db5e2b)


## 附录：报错

打开 Lagent Web Demo 页面时报错：
```
Traceback (most recent call last):
  File "/root/.conda/envs/lagent/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/exec_code.py", line 88, in exec_func_with_error_handling
    result = func()
  File "/root/.conda/envs/lagent/lib/python3.10/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 579, in code_to_exec
    exec(code, module.__dict__)
  File "/root/agent_camp4/lagent/examples/internlm2_agent_web_demo.py", line 8, in <module>
    from lagent.actions import ActionExecutor, ArxivSearch, IPythonInterpreter
  File "/root/agent_camp4/lagent/lagent/__init__.py", line 2, in <module>
    from .actions import *  # noqa: F401, F403
  File "/root/agent_camp4/lagent/lagent/actions/__init__.py", line 3, in <module>
    from .action_executor import ActionExecutor
  File "/root/agent_camp4/lagent/lagent/actions/action_executor.py", line 4, in <module>
    from .base_action import BaseAction
  File "/root/agent_camp4/lagent/lagent/actions/base_action.py", line 14, in <module>
    from class_registry import AutoRegister, ClassRegistry
ImportError: cannot import name 'AutoRegister' from 'class_registry' (/root/.conda/envs/lagent/lib/python3.10/site-packages/class_registry/__init__.py)
```

解决：
```
pip install class_registry
```


